@using BlindBoxShop.Service.Contract
@using BlindBoxShop.Shared.Enum
@page "/"

<PageTitle>BlindBox Shop - Mystery Awaits</PageTitle>

<MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="px-2 px-sm-4 mt-4">
    <!-- Hero Banner -->
    <MudPaper Elevation="0" Class="relative overflow-hidden rounded-xl mb-8" Style="height: 500px;">
        <MudImage Src="/images/banner-placeholder.jpg" Alt="BlindBox Hero" Class="object-cover w-full h-full" Style="filter: brightness(0.7);" />
        <div class="absolute inset-0 flex flex-col items-center justify-center text-center p-4 bg-gradient-to-r from-teal-900/50 to-cyan-900/50">
            <MudText Typo="Typo.h2" Color="Color.Surface" Class="font-weight-bold mb-2 text-shadow">Discover the Mystery Box Experience</MudText>
            <MudText Typo="Typo.h5" Color="Color.Surface" Class="mb-6 text-shadow">Unbox Excitement with Our Limited Edition Collections</MudText>
            <MudButton Href="/shop" Variant="Variant.Filled" Color="Color.Secondary" Size="Size.Large" Class="rounded-pill px-8 py-3 mud-elevation-4 text-transform-none font-weight-bold">Shop Now</MudButton>
        </div>
    </MudPaper>

    <!-- Featured Categories -->
    <div class="d-flex justify-space-between align-center mb-4">
        <MudText Typo="Typo.h4" Class="section-title">
            Featured Categories
        </MudText>
    </div>
    <MudGrid Class="mb-10" Spacing="3">
        @foreach (var category in _featuredCategories)
        {
            <MudItem xs="12" sm="6" md="4">
                <MudPaper Elevation="3" Class="pa-0 h-100 d-flex flex-column rounded-lg overflow-hidden mud-transition-on-hover">
                    <div class="position-relative overflow-hidden" style="height: 220px;">
                        <MudImage Src="@category.ImageUrl" Alt="@category.Name" Class="w-full h-full object-cover mud-transition transform duration-500 mud-hover:scale-110" />
                        <div class="position-absolute" style="bottom: 0; left: 0; right: 0; background-image: linear-gradient(to top, rgba(0,0,0,0.7), transparent); height: 100%;">
                            <div class="position-absolute" style="bottom: 0; left: 0; right: 0; padding: 1.5rem;">
                                <MudText Typo="Typo.h5" Color="Color.Surface" Class="font-weight-bold mb-2">@category.Name</MudText>
                            </div>
                        </div>
                    </div>
                    <div class="pa-4 d-flex flex-column flex-grow-1">
                        <MudText Typo="Typo.body1" Class="mb-4 flex-grow-1">@category.Description</MudText>
                        <div class="d-flex justify-end">
                            <MudButton Variant="Variant.Text" Color="Color.Secondary" EndIcon="@Icons.Material.Filled.ArrowForward" Class="px-2 text-transform-none">Explore Collection</MudButton>
                        </div>
                    </div>
                </MudPaper>
            </MudItem>
        }
    </MudGrid>

    <!-- New Arrivals -->
    <div class="d-flex justify-space-between align-center mb-4 mt-8">
        <MudText Typo="Typo.h4" Class="section-title">
            New Arrivals
        </MudText>
        <MudButton Href="/shop" Variant="Variant.Text" Color="Color.Secondary" EndIcon="@Icons.Material.Filled.ArrowForward" Class="text-transform-none">View All</MudButton>
    </div>
    <MudGrid Class="mb-10" Spacing="3">
        @foreach (var box in _newArrivals)
        {
            <MudItem xs="12" sm="6" md="3">
                <MudPaper Elevation="3" Class="pa-0 h-100 d-flex flex-column rounded-lg overflow-hidden mud-transition-on-hover mud-hover:mud-elevation-8">
                    <div class="position-relative overflow-hidden" style="height: 240px; cursor: pointer;" @onclick="@(() => NavigateToProductDetail(box.Id))">
                        <MudImage Src="@box.ImageUrl" Alt="@box.Name" Class="w-full h-full object-cover mud-transition transform duration-500 mud-hover:scale-110" />
                        <MudChip T="string" Color="@GetRarityColor(box.Rarity)" Size="Size.Small" 
                                Class="position-absolute top-0 end-0 ma-2 px-2 font-weight-bold text-capitalize">
                            @box.Rarity.ToString()
                        </MudChip>
                    </div>
                    <div class="pa-4 d-flex flex-column flex-grow-1">
                        <MudText Typo="Typo.h6" Class="mb-2 text-truncate font-weight-bold" Style="cursor: pointer;" @onclick="@(() => NavigateToProductDetail(box.Id))">@box.Name</MudText>
                        <div class="d-flex align-center mb-2">
                            <MudRating ReadOnly="true" SelectedValue="@box.Rating" />
                            <MudText Typo="Typo.caption" Class="ml-1">(@box.ReviewCount)</MudText>
                        </div>
                        <MudText Typo="Typo.body2" Class="mb-3 flex-grow-1" Style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                            @box.Description
                        </MudText>
                        <MudText Typo="Typo.h6" Color="Color.Primary" Class="font-weight-bold mb-3">@FormatPrice(box.Price)</MudText>
                        <div class="d-flex">
                            <MudButton Variant="Variant.Text" 
                                      Color="Color.Primary" 
                                      StartIcon="@Icons.Material.Filled.Visibility" 
                                      Href="@($"/shop/{box.Id}")"
                                      Class="flex-grow-0 px-2 text-transform-none">Details</MudButton>
                            <MudSpacer />
                            <MudButton Variant="Variant.Filled" Color="Color.Secondary" StartIcon="@Icons.Material.Filled.ShoppingCart" Class="text-transform-none">Add to Cart</MudButton>
                        </div>
                    </div>
                </MudPaper>
            </MudItem>
        }
    </MudGrid>

    <!-- Popular Collections -->
    <div class="d-flex justify-space-between align-center mb-4 mt-8">
        <MudText Typo="Typo.h4" Class="section-title">
            Featured Collections
        </MudText>
    </div>
    <MudGrid Class="mb-10" Spacing="3">
        @foreach (var collection in _popularCollections)
        {
            <MudItem xs="12" sm="6">
                <MudPaper Elevation="3" Class="overflow-hidden rounded-lg mud-transition-on-hover mud-hover:mud-elevation-8">
                    <div class="d-flex flex-column flex-md-row">
                        <div class="flex-shrink-0 position-relative overflow-hidden" style="min-width: 250px; height: 280px;">
                            <MudImage Src="@collection.ImageUrl" Alt="@collection.Name" Class="w-full h-full object-cover mud-transition transform duration-500 mud-hover:scale-110" />
                        </div>
                        <div class="pa-6 d-flex flex-column justify-center flex-grow-1">
                            <MudText Typo="Typo.h5" Class="mb-2 font-weight-bold">@collection.Name</MudText>
                            <MudText Typo="Typo.body1" Class="mb-4">@collection.Description</MudText>
                            <div class="d-flex align-center mb-4">
                                <MudChip T="string" Icon="@Icons.Material.Filled.Inventory" Color="Color.Primary" Size="Size.Small" Class="mr-2">@collection.ItemCount items</MudChip>
                            </div>
                            <MudButton Variant="Variant.Filled" Color="Color.Secondary" FullWidth="true" Class="text-transform-none rounded-pill">Explore Collection</MudButton>
                        </div>
                    </div>
                </MudPaper>
            </MudItem>
        }
    </MudGrid>

    <!-- Testimonials -->
    <MudText Typo="Typo.h4" Class="mb-6 section-title">
        Customer Reviews
    </MudText>
    <MudPaper Elevation="0" Class="mb-10 pa-0 overflow-hidden" Style="background-color: rgba(72, 209, 204, 0.05); border-radius: 16px;">
        <MudCarousel AutoCycle="true" TData="TestimonialDto" ShowArrows="true" ShowBullets="true" EnableSwipeGesture="true" Style="height: 320px;">
            @foreach (var testimonial in _testimonials)
            {
                <MudCarouselItem>
                    <MudPaper Elevation="0" Class="py-8 px-4 mx-2 h-full d-flex flex-column align-center justify-center text-center" Style="background-color: transparent;">
                        <MudAvatar Size="Size.Large" Image="@testimonial.AvatarUrl" Class="mb-4 mud-elevation-4" Style="height: 80px; width: 80px;" />
                        <MudRating ReadOnly="true" SelectedValue="@testimonial.Rating" Class="mb-4" />
                        <MudText Typo="Typo.h6" Class="mb-1 font-weight-bold">@testimonial.Name</MudText>
                        <MudText Typo="Typo.caption" Class="mb-4 text-secondary">@testimonial.Date.ToString("MMMM dd, yyyy")</MudText>
                        <MudText Typo="Typo.body1" Class="font-italic px-md-16">"@testimonial.Comment"</MudText>
                    </MudPaper>
                </MudCarouselItem>
            }
        </MudCarousel>
    </MudPaper>

    <!-- Newsletter Section with Custom Design -->
    <MudPaper Elevation="3" Class="mb-8 rounded-xl overflow-hidden" Style="background: linear-gradient(135deg, #008b8b 0%, #48d1cc 100%);">
        <div class="px-6 py-8 d-flex flex-column flex-md-row align-center justify-space-between">
            <div class="mb-4 mb-md-0 mr-md-8 flex-grow-1">
                <MudText Typo="Typo.h4" Color="Color.Surface" Class="font-weight-bold mb-2">Stay Updated</MudText>
                <MudText Typo="Typo.body1" Color="Color.Surface" Style="opacity: 0.9;">Subscribe to get notified about new releases and exclusive promotions</MudText>
            </div>
            <div class="d-flex flex-column flex-sm-row flex-grow-1 flex-md-grow-0" style="max-width: 500px;">
                <MudTextField T="string" Placeholder="Your Email" Variant="Variant.Outlined" Class="bg-white/10 rounded-tl-lg rounded-tr-lg rounded-bl-none rounded-br-none rounded-tr-sm-none rounded-br-sm-none mb-2 mb-sm-0 flex-grow-1" Style="backdrop-filter: blur(5px);" InputClass="text-white" PlaceholderClass="text-white/70" />
                <MudButton Variant="Variant.Filled" Color="Color.Secondary" Size="Size.Large" Class="rounded-tl-none rounded-bl-none rounded-tr-lg rounded-br-lg rounded-tl-sm-none text-transform-none font-weight-bold">Subscribe</MudButton>
            </div>
        </div>
    </MudPaper>
</MudContainer>

<style>
    .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }
    
    .rounded-pill {
        border-radius: 50rem !important;
    }
    
    .mud-transition {
        transition: all 0.3s ease-in-out;
    }
    
    .mud-transition-on-hover:hover {
        transform: translateY(-5px);
    }
    
    .transform {
        transform: scale(1);
    }
    
    .duration-500 {
        transition-duration: 500ms;
    }
    
    .mud-hover\:scale-110:hover {
        transform: scale(1.1);
    }
    
    .mud-hover\:mud-elevation-8:hover {
        box-shadow: var(--mud-elevation-8);
    }
</style>

